"""
Author: Gabriel Hubert
Date: 2025-01-26
Professor: Tyler DeLay
Assignment: Practical Project 1
Description: This program reads the first few records from a CSV file and displays them in a tabular format.
"""
import csv
from record import Record # Import the Record class from record.py

def load_records_from_csv(file_path):
    records = []
    try:
        with open(file_path, mode='r', encoding='utf-8') as file:
            csv_reader = csv.DictReader(file)
            for row in csv_reader:
                record = Record(
                    csduid=row['CSDUID'],
                    csd=row['CSD'],
                    period=row['Period'],
                    indicator_summary_description=row['IndicatorSummaryDescription'],
                    unit_of_measure=row['UnitOfMeasure'],
                    original_value=row['OriginalValue']
                )
                records.append(record)
                if len(records) >= 20:  # Limit to first few records for initialization
                    break
    except FileNotFoundError:
        print(f"Error: The file '{file_path}' was not found.")
    except KeyError as e:
        print(f"Error: Missing expected column in CSV file: {e}")
    except Exception as e:
        print(f"An unexpected error occurred: {e}")
    return records

if __name__ == "__main__":
    file_path = "C:\School\Programming Research\CST8002_PracticalProject_040_Gabriel-Hubert\src\dailyvehiclesdownload.csv"  # CSV file location
    records = load_records_from_csv(file_path)
    print("Author: Gabriel Hubert")
    print("Records:")
    print("CSDUID, CSD, Period, IndicatorSummaryDescription, UnitOfMeasure, OriginalValue")
    for record in records:
        print(f"{record.csduid}, {record.csd}, {record.period}, {record.indicator_summary_description}, {record.unit_of_measure}, {record.original_value}")